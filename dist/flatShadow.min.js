class FlatShadow{constructor(e){this.elementToAttachTo=e,this.fsid=Date.now().toString(),this.elementToAttachTo.dataset.fsid=this.fsid,this.isTextNode=this.checkForTextNode();let t=this.elementToAttachTo.attributes;this.angle=t.getNamedItem("flatshadowangle")?parseInt(t.getNamedItem("flatshadowangle").value):45,this.color=t.getNamedItem("flatshadowcolor")?t.getNamedItem("flatshadowcolor").value:this.calculateColor(),this.blur=t.getNamedItem("flatshadowblur")?parseInt(t.getNamedItem("flatshadowblur").value):0,this.shadowLength=t.getNamedItem("FlatShadowlength")?parseInt(t.getNamedItem("flatshadowlength").value):1e3,this.step=t.getNamedItem("FlatShadowstepsize")?parseInt(t.getNamedItem("flatshadowstepsize").value):2,this.trackingEnabled=!!t.getNamedItem("flatshadowenabletracking")&&t.getNamedItem("flatshadowenabletracking").value,this.loggingEnabled=!!t.getNamedItem("flatshadowenablelogging")&&t.getNamedItem("flatshadowenablelogging").value,this.renderShadow(),this.createTracker(),this.loggingEnabled&&console.log(this)}checkForTouchDevice(){return window.matchMedia("@media (any-hover: none)").matches}checkForTextNode(){let e=!0;return this.elementToAttachTo.childNodes.forEach(t=>{3!=t.nodeType&&(e=!1)}),e}calculateColor(){let e=window.getComputedStyle(this.elementToAttachTo.parentElement).backgroundColor.match(/\d+/gim);return`rgb(${e[0]-10}, ${e[1]-10}, ${e[2]-10})`}renderShadow(){document.querySelector(`._${this.fsid}`)&&document.querySelector(`._${this.fsid}`).remove();let e=document.createElement("link");e.rel="stylesheet",e.className=`_${this.fsid}`,e.href="data:text/css,"+`[data-fsid="${this.fsid}"]{\n\t\t\t\t${this.isTextNode?"text-shadow: ":"box-shadow: "}${(()=>{let e=`0px 0px 0px ${this.color}`,t=Math.sin(this.angle*(Math.PI/180)).toFixed(2),a=Math.cos(this.angle*(Math.PI/180)).toFixed(2);for(let o=0;o<this.shadowLength;o+=this.step)e+=`, ${o*t}px ${o*a}px ${this.blur}px ${this.color}`;return e})()} !important;\n\t\t}`,document.querySelector("head").appendChild(e)}createTracker(){this.trackingEnabled&&!this.checkForTouchDevice()&&window.addEventListener("mousemove",e=>{window.requestAnimationFrame(this.trackMouseMovement.bind(this,e))},!0)}trackMouseMovement(e){let t={x:e.clientX,y:e.clientY},a=this.elementToAttachTo.getBoundingClientRect(),o={x:a.left+a.width/2,y:a.top+a.height/2},h={x:o.x,y:t.y};const s=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));let d=s(t,o),i=s(o,h),l=Math.acos(i/d)*(180/Math.PI);this.angle=t.y<o.y?t.x<o.x?l:-1*l+360:t.x<o.x?-1*l+180:l-180,a.bottom>0&&a.top<window.innerHeight&&this.renderShadow()}setAngle(e){this.angle=e,this.renderShadow()}setColor(e){this.color=e,this.renderShadow()}setBlur(e){this.blur=e,this.renderShadow()}setStep(e){this.step=e,this.renderShadow()}length(e){this.shadowLength=e,this.renderShadow()}}window.addEventListener("DOMContentLoaded",e=>{document.querySelectorAll(".flatShadow").forEach(e=>new FlatShadow(e))});